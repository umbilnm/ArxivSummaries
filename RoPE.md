Вид позиционного кодирования, появившийся после классического, которое было представлено в [[Attention is all you need..]].
![[Pasted image 20241013200913.png|600]]

Также существует подход, когда создают отдельный обучаемый слой позиционных эмбеддингов. У этого подхода есть недостаток, который заключается в том, что после обучения невозможно экстраполировать эти данные на последовательности большей длины.

### Идея Rope

![[Pasted image 20241013201923.png]]

Мы хотим сделать такую функцию, что после применения ее к query и key векторам, их dot-product содержит информацию об **относительных** позициях токенов, но не содеражит информацию об абсолютных.

Так выглядит преобразование для 2мерного вектора.

![[Pasted image 20241013202451.png]]

Обобщение для пространства размерности *d:*
![[Pasted image 20241013202515.png]]

Вектор разбивается на пары $(x_1, x_2), (x_3, x_4) ... (x_{d-1}, x_d)$